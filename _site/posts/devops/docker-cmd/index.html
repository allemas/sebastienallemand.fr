<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="title" content="Blog | Sébastien ALLEMAND">
  <meta name="description" content="Creation d&#39;images docker, démarrage d&#39;un container et gestion des network et volumes">

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://sebastienallemand.fr/">
  <meta property="og:title" content="Docker Commands - Toolbox | Sébastien ALLEMAND">
  <meta property="og:description" content="Creation d&#39;images docker, démarrage d&#39;un container et gestion des network et volumes">
  <meta property="og:image" content="./../../../assets/all/banner.jpeg">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://sebastienallemand.fr/">
  <meta property="twitter:title" content="Docker Commands - Toolbox | Sébastien ALLEMAND">
  <meta property="twitter:description" content="Creation d&#39;images docker, démarrage d&#39;un container et gestion des network et volumes">
  <meta property="twitter:image" content="./../../../assets/all/banner.jpeg">

  <link rel="alternate" type="application/rss+xml" href="/feed/feed.xml">

  <title>Docker Commands - Toolbox | Sébastien ALLEMAND</title>
  <style>body,
html {
  margin: 0;
  padding: 0;
}

body {
  color: #444;
  font-family: 'Source Sans Pro', Georgia, Cambria, Times New Roman, Times, serif;
  font-size: calc(16px + 4 * ((100vw - 320px) / 2680));
  line-height: 1.6;
  text-align: center
}

/*------ Links ----------*/
a, a:link, a:visited {
  text-decoration: none;
  color: #222
}

/*------ Footer ----------*/
footer {
  color: #3d4449;
  font-size: .7em;
  padding-bottom: 2em;
  padding-top: 2em;
  border-top: 1px solid #eee;
}

/*------ h1, h2, h3, h4 ----------*/
h1, h2, h3, h4 {
  color: #333333;
  line-height: 1;
  font-family: 'Source Sans Pro', sans-serif;
}

h1.headline {
  font-size: 3.5rem;
}

/*------ Container ----------*/
.container {
  margin-left: auto;
  margin-right: auto;
  text-align: left;
  width: 90%
}

@media (min-width: 800px) {
  .container {
    width: 800px
  }
}

@media only screen and (min-width: 1024px) {
  .container {
    width: 960px
  }
}

figure {
  margin-left: 0;
  margin-right: 0
}

figcaption {
  color: #888;
  font-size: .7em;
  text-align: center
}


blockquote {
  border-left: 3px solid #888;
  font-style: italic;
  margin-bottom: 0;
  margin-left: -2em;
  margin-top: 0;
  padding-bottom: .5em;
  padding-left: 2em;
  padding-top: .5em
}

blockquote em {
  font-style: normal
}

/*pre {
  background-color: #eee;
  font-size: .7em;
  margin-bottom: 0;
  margin-top: 0;
  padding: 1em;
}*/

hr {
  border-bottom: 1px solid #eee;
  border-style: none;
  margin-bottom: 3em;
  margin-top: 2em
}


ul.listing {
  list-style: none;
  list-style-position: outside;
  padding-left: 0;
/ / padding-top: 1.5 em
}

ul.listing li {
  margin-bottom: 1em
}

ul.listing .list-headline{
  font-size: 1.8rem;
}

ul.listing h3 {
  margin-top: .2rem;
  margin-bottom: .2rem;
  padding: 0;
}

ul.listing p.meta {
  margin: 0;
  padding: 0;
}


.menu-container {
  text-align: center;
  padding-top: 1.5rem;
  padding-bottom: 1.5rem;
}

.menu-container a {
  font-size: 1.8rem;
  font-weight: 600;
  font-family: 'Source Sans Pro', Georgia, Cambria, Times New Roman, Times, serif;
  text-transform: capitalize;
}

.pager-link
{
  font-size: 1.2rem;
  font-weight: 600;
  padding-top: 0.1rem;
  padding-bottom: 0.1rem;
  padding-left: 0.3rem;
  padding-right: 0.3rem;
  border: 2px solid black;
  font-family: 'Source Sans Pro', Georgia, Cambria, Times New Roman, Times, serif;
  text-transform: capitalize;
}


.post-content img {
  width: 100%
}

p.meta {
  color: #444;
  font-size: .8em;
  font-style: italic;
}


.tag {
  text-transform: capitalize;
  border-bottom: 1px dotted #515151;
}

.tag:hover {
  text-transform: capitalize;
  border-bottom: 1px solid #000;
}

.tag-homepage {
  text-transform: lowercase;
  border-bottom: 1px dotted #515151;
  font-size: 1.1rem;
}

.tag-homepage:hover {
  border-bottom: 1px solid #000;
  font-size: 1.1rem;
}

.nav-element-left {
  width: 395px;
  right: 0;
  display: inline-block;
  position: relative;
  text-align: left;
}

.nav-element-right {
  width: 395px;
  right: 0;
  display: inline-block;
  position: relative;
  text-align: right;
}

img[src*='#left'] {
  float: left;
}

img[src*='#right'] {
  float: right;
}

img[src*='#center'] {
  position: relative;
  display: block;
  margin: auto;
  max-width: 100%;
}

img[src*='#banner'] {
  position: relative;
  display: block;
  width: 100%;
}


.pager {
  text-align: center;
}

.footer-article {
  margin-top: 3rem;
}

</style>
  <style>
@import url('https://fonts.googleapis.com/css?family=Poppins');

@import url('https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700;900&display=swap');

.logo-wrapper {
    width: auto;
    margin: 0 auto;
    text-align: center;
    font-weight: 500;
    font-family: 'Poppins', sans-serif;
}

.hp-logo {
    padding-top: 2rem
}

.logo-wrapper a {
    text-decoration: none;
}

.logo-wrapper>a>.logo {
    width: auto;
    display: inline-block;
    text-align: right;
    font-family: 'Poppins', sans-serif;
    font-weight: bold;
}

.logo-wrapper>a>.logo>.name-title {
    margin: 0px;
    font-size: calc(1.6rem + .6 * ((100vw - 320px) / 2680));
    font-weight: bold;
    font-family: 'Poppins', sans-serif;
}

.logo-wrapper span.background-title,
.blog-title {
    text-transform: uppercase;
    font-size: calc(4.5rem + .5 * ((100vw - 320px) / 2680));
    letter-spacing: -11px;
    line-height: 3.8rem;
    display: inline;
    text-align: left;
}







span.background-title .background-title-spare,
.blog-title .background-title-spare {
    display: inline;
    color: #f02;
}

.baseline {
    color: #444;
    text-align: center;
    font-weight: 300;
    font-size: calc(1.2rem + .3 * ((100vw - 320px) / 2680));
}

.logo-post-header {
    text-align: left;
}

.logo-post-header>a>.logo>.name-title {
    font-size: calc(1.2rem + .6 * ((100vw - 320px) / 2680));
}

.logo-post-header span.background-title,
.blog-title {
    letter-spacing: -8px;
    font-size: calc(2.8rem + .5 * ((100vw - 320px) / 2680));
}
</style>
  <link rel="stylesheet"
        href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/monokai-sublime.min.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>
<header class="container header-logo">
  <div class="logo-wrapper hp-logo">
    <a href="/" class="site-link">
      <div class="logo">
        <h1 class="name-title">SEBASTIEN</h1>
        <h1 class="name-title">ALLEMAND</h1>
      </div>
      <div class="blog-title">
        <span class="background-title">Blog <span class="background-title-spare">.</span></span>
      </div>
    </a>
  </div>
</header>

<div class="container menu-container">
  <a href="/">← Blog</a> - <a href="/tags/crafting">Software Crafting</a> - <a href="/tags/devops">Devops</a> - <a href="/pages/a-propos">A propos</a>
</div>
<div class="content" role="main" id="main">
    <article class="container">
      <div class="title-wrapper">
  <h1 class="headline">Docker Commands - Toolbox</h1>
</div>

<div class="meta">
  <span>Temps de lecture environ 2 min</span>
</div>

<div class="wrapper-content">
  <p><img src="./../../../assets/devops/docker-images-process.png#center" alt=""></p>
<h1 id="dockerfile">Dockerfile <a class="direct-link" href="#dockerfile">#</a></h1>
<p>Une image Docker est crée a partir d'un fichier Dockerfile représentant la structure du conteneur. On peut y trouver plusieurs éléments comme des librairies logicielles, une application, de la configuration, l'utilisation de volumes etc. Une fois cette image construire il sera possible de lancer plusieurs container basés sur la même image.</p>
<h1 id="construire-une-image">Construire une image <a class="direct-link" href="#construire-une-image">#</a></h1>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker build -t <span class="token operator">&lt;</span>docker_repository<span class="token operator">></span>/<span class="token operator">&lt;</span>image_name<span class="token operator">></span> <span class="token builtin class-name">.</span></span></code></pre>
<p>Le <code>.</code> défini que le dockerfile est disposé dans le dossier courant.</p>
<h1 id="lister-les-images-docker-disponible-sur-la-machine">Lister les images docker disponible sur la machine <a class="direct-link" href="#lister-les-images-docker-disponible-sur-la-machine">#</a></h1>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker images</span></code></pre>
<h1 id="ignorer-des-fichiers-dans-une-image-docker-avec-dockerignore">Ignorer des fichiers dans une image docker avec dockerignore <a class="direct-link" href="#ignorer-des-fichiers-dans-une-image-docker-avec-dockerignore">#</a></h1>
<p>Fichier  .dockerignore<br>
<em>example:</em></p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">node_modules</span><br><span class="highlight-line">npm-debug.log</span><br><span class="highlight-line">Dockerfile</span><br><span class="highlight-line">.dockerignore</span></code></pre>
<hr>
<h1 id="conteneur-docker">Conteneur Docker <a class="direct-link" href="#conteneur-docker">#</a></h1>
<p>Un conteneur est comme nous venons de le dire basé sur une image Docker, un conteneur comprend un système d'exploitation, du code applicatif, de la configuration middleware, et etc. Il peut être facilement déplacés et facilite grandement la gestion des infrastructures (surtout en développement).</p>
<h1 id="demarrer-un-container">Demarrer un container <a class="direct-link" href="#demarrer-un-container">#</a></h1>
<p>Note : Avant de démarrer un container il est necessaire de le construire (voir commande docker build)</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker run --name <span class="token operator">&lt;</span>container_name<span class="token operator">></span> -p <span class="token operator">&lt;</span>local_port<span class="token operator">></span>:<span class="token operator">&lt;</span>container_port<span class="token operator">></span> -d <span class="token operator">&lt;</span>docker_repository<span class="token operator">></span>/<span class="token operator">&lt;</span>image_name<span class="token operator">></span></span></code></pre>
<ul>
<li><code>--name</code> spécifie le nom du container</li>
<li><code>-p &lt;local_port&gt;:&lt;container_port&gt;</code> permet de spécifier la correspondance des ports</li>
<li><code>-d</code> permet de démarrer le container en monde daemon (en tache de fond)</li>
</ul>
<h1 id="supprimer-un-container-et-son-image">Supprimer un container et son image <a class="direct-link" href="#supprimer-un-container-et-son-image">#</a></h1>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker <span class="token function">rm</span> -v container_name</span></code></pre>
<h1 id="mode-int%C3%A9ractif">Mode intéractif <a class="direct-link" href="#mode-int%C3%A9ractif">#</a></h1>
<p>Permet de d'exécuter un commande dans le container et d'intéragir avec. Souvent on utilise la commande pour ouvrir un shell.</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker <span class="token builtin class-name">exec</span> -it <span class="token operator">&lt;</span>name_container<span class="token operator">></span> bash`</span></code></pre>
<h1 id="supprimer-tous-les-containers-inactifs">Supprimer tous les containers inactifs <a class="direct-link" href="#supprimer-tous-les-containers-inactifs">#</a></h1>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker container prune</span></code></pre>
<hr>
<h1 id="docker-network">Docker Network <a class="direct-link" href="#docker-network">#</a></h1>
<p>Un Docker network est un réseau crée entre plusieurs conteneur. Il permet d'assurer la communiquer entre plusieurs conteneurs.<br>
Créer un Docker Network permet de limiter les risques en isolant par le reseau les conteneurs et évite les conflits entre des conteneurs qui n'auraient pas a communiquer.</p>
<h1 id="cr%C3%A9er-un-r%C3%A9seau">Créer un réseau <a class="direct-link" href="#cr%C3%A9er-un-r%C3%A9seau">#</a></h1>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker network create <span class="token operator">&lt;</span>name<span class="token operator">></span></span></code></pre>
<h2 id="connecter-un-conteneur-a-un-r%C3%A9seau">Connecter un conteneur a un réseau <a class="direct-link" href="#connecter-un-conteneur-a-un-r%C3%A9seau">#</a></h2>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker network connect <span class="token operator">&lt;</span>network_name<span class="token operator">></span> <span class="token operator">&lt;</span>container_name<span class="token operator">></span></span></code></pre>
<p><em>When you create a new container, you can specify one or more --network flags. This example connects a Nginx container to the my-net network. It also publishes port 80 in the container to port 8080 on the Docker host, so external clients can access that port. Any other container connected to the my-net network has access to all ports on the my-nginx container, and vice versa.</em></p>
<h2 id="network-inspect">Network inspect <a class="direct-link" href="#network-inspect">#</a></h2>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker network inspect</span></code></pre>
<h3 id="networking-container">Networking container <a class="direct-link" href="#networking-container">#</a></h3>
<p>Connected to bridge manualy</p>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">root@1f87bccac67c:/<span class="token operator">></span> <span class="token function">cat</span> /etc/hosts</span><br><span class="highlight-line"><span class="token number">127.0</span>.0.1	localhost</span><br><span class="highlight-line">::1	localhost ip6-localhost ip6-loopback</span><br><span class="highlight-line">fe00::0	ip6-localnet</span><br><span class="highlight-line"><span class="token punctuation">..</span>.</span><br><span class="highlight-line"><span class="token number">172.17</span>.0.2	1f87bccac67c   <span class="token operator">&lt;</span>--</span><br><span class="highlight-line"><span class="token number">172.18</span>.0.2	1f87bccac67c   <span class="token operator">&lt;</span>--</span></code></pre>
<p>Pour aller plus loins :  <a href="https://runnable.com/docker/basic-docker-networking">Basic networking</a></p>
<hr>
<h1 id="docker-volumes">Docker Volumes <a class="direct-link" href="#docker-volumes">#</a></h1>
<p>Un Docker Volume est un système de fichier, monté au démarrage d'un conteneur.<br>
Un conteneur par design ne stocke <strong>aucunes</strong> données il ne dispose qu'uniquement des données en lecture seules.<br>
Quand un conteneur modifie une donnée la donnée traverse les couches(layers) du conteneur puis cette donnée est modifiée dans le système de fichier monté au démarrage. C'est un volume.</p>
<h3 id="creer-un-volume-%3A">Creer un volume : <a class="direct-link" href="#creer-un-volume-%3A">#</a></h3>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker volume create <span class="token operator">&lt;</span>name<span class="token operator">></span>`</span></code></pre>
<h3 id="lister-les-volumes-%3A">Lister les volumes : <a class="direct-link" href="#lister-les-volumes-%3A">#</a></h3>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line"><span class="token variable"><span class="token variable">`</span>docker volume <span class="token function">ls</span> <span class="token variable">`</span></span></span></code></pre>
<h3 id="supprimer-les-volumes-non-utilis%C3%A9s-%3A">Supprimer les volumes non utilisés : <a class="direct-link" href="#supprimer-les-volumes-non-utilis%C3%A9s-%3A">#</a></h3>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker volume prune</span></code></pre>
<h2 id="monter-un-volume-dans-un-conteneur-docker">Monter un volume dans un conteneur docker <a class="direct-link" href="#monter-un-volume-dans-un-conteneur-docker">#</a></h2>
<pre class="language-bash"><code class="language-bash"><span class="highlight-line">docker run --name snginx -p <span class="token number">8080</span>:80 --mount <span class="token assign-left variable">source</span><span class="token operator">=</span>my-vol,target<span class="token operator">=</span>/var/www/html s/nginx</span></code></pre>
<p><a href="https://www.digitalocean.com/community/tutorials/how-to-build-a-node-js-application-with-docker-quickstart">how-to-build-a-node-js-application-with-docker-quickstart</a></p>
<h1 id="diff%C3%A9rence-entre-conteneur-et-vm">Différence entre conteneur et VM <a class="direct-link" href="#diff%C3%A9rence-entre-conteneur-et-vm">#</a></h1>
<p><img src="./../../../assets/devops/docker-vm.png#center" alt=""></p>
<p>Un conteneur et une VM ont des aspects d'isolation similaires, mais leurs fonctionnement est différent la ou une VM virtualise les couches hardware un conteneur virtualise le système d'exploitation et sa configuration.<br>
Un conteneur docker va uniquement contenir le code et les dépendances d'une applications la ou une machine virtuelle va démarrer une nouvelle machine(virtuelle) complètement indépendante.</p>

</div>

<div class="footer-article">
  
  <i>Mots clés :   <a href="/tags/devops/"
                                                                                       class="tag">devops</a>  <a href="/tags/experiments/"
                                                                                       class="tag">experiments</a></i><br>
  
  <i>Auteur : Allemand Sébastien</i>
</div>
</article>
<hr>
</div>
<div class="container">
  
  <p class="ctr nav-element-left">
    <a class="previous" href="/posts/craft/practical-test-pyramid/">← Prev.</a>
  </p>
  

  
  <p class="ctr nav-element-right">
    <a class="next" href="/posts/craft/legacy-code/">Suiv. →</a>
  </p>
  
</div>

  </div>
</div>
<footer>
  <div class="container">
    © 2020 <a href="https://twitter.com/allema_s">Sébastien Allemand</a> généré avec <a href="https://11ty.io">Eleventy</a>.
  </div>
</footer>
</body>
</html>

